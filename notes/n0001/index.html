<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Lua | Hidewnd Docs</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="藏经阁">
    <meta name="keywords" content="个人博客">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.539c6dcc.css" as="style"><link rel="preload" href="/assets/js/app.5a211078.js" as="script"><link rel="preload" href="/assets/js/2.246ca7c3.js" as="script"><link rel="preload" href="/assets/js/16.13dc6cfd.js" as="script"><link rel="prefetch" href="/assets/js/10.738cf037.js"><link rel="prefetch" href="/assets/js/11.4589cc69.js"><link rel="prefetch" href="/assets/js/12.5ea06f0c.js"><link rel="prefetch" href="/assets/js/13.f9e798fd.js"><link rel="prefetch" href="/assets/js/14.d6294c12.js"><link rel="prefetch" href="/assets/js/15.74f0f1ea.js"><link rel="prefetch" href="/assets/js/17.818902bf.js"><link rel="prefetch" href="/assets/js/18.29c774c5.js"><link rel="prefetch" href="/assets/js/19.961cd5b7.js"><link rel="prefetch" href="/assets/js/20.ee14e2f6.js"><link rel="prefetch" href="/assets/js/21.3febe55f.js"><link rel="prefetch" href="/assets/js/22.aac2a6b0.js"><link rel="prefetch" href="/assets/js/23.4abd4b3c.js"><link rel="prefetch" href="/assets/js/24.4e7c3e21.js"><link rel="prefetch" href="/assets/js/25.00212a1d.js"><link rel="prefetch" href="/assets/js/26.51112c3d.js"><link rel="prefetch" href="/assets/js/27.e5025d1b.js"><link rel="prefetch" href="/assets/js/28.f5f536d4.js"><link rel="prefetch" href="/assets/js/29.47dfd511.js"><link rel="prefetch" href="/assets/js/3.33fa30ce.js"><link rel="prefetch" href="/assets/js/30.bbe1778a.js"><link rel="prefetch" href="/assets/js/31.2f99b59c.js"><link rel="prefetch" href="/assets/js/32.100c4dea.js"><link rel="prefetch" href="/assets/js/33.25e7982f.js"><link rel="prefetch" href="/assets/js/34.88d35141.js"><link rel="prefetch" href="/assets/js/4.29479e24.js"><link rel="prefetch" href="/assets/js/5.ecb9e4d0.js"><link rel="prefetch" href="/assets/js/6.f1901f8c.js"><link rel="prefetch" href="/assets/js/7.ba93cf3a.js"><link rel="prefetch" href="/assets/js/8.a4e93d3f.js"><link rel="prefetch" href="/assets/js/9.294d7e4f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.539c6dcc.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="Hidewnd Docs" class="logo"> <span class="site-name can-hide">Hidewnd Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章" class="dropdown-title"><!----> <span class="title" style="display:;">文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/d0001/" class="nav-link">常用开发环境</a></li><li class="dropdown-item"><!----> <a href="/doc/d0002/" class="nav-link">常用提示词</a></li><li class="dropdown-item"><!----> <a href="/doc/d0003/" class="nav-link">常用Linux命令</a></li><li class="dropdown-item"><!----> <a href="/doc/d0004/" class="nav-link">Java开发聊天机器人</a></li><li class="dropdown-item"><!----> <a href="/doc/d0005/" class="nav-link">word模板生成实现方案</a></li><li class="dropdown-item"><!----> <a href="/doc/d0006/" class="nav-link">基于Go写一个极简的通讯demo</a></li><li class="dropdown-item"><!----> <a href="/doc/d0007/" class="nav-link">SpringBoot配置文件加密处理</a></li><li class="dropdown-item"><!----> <a href="/doc/d0008/" class="nav-link">SpringBoot优雅的抛出业务异常</a></li><li class="dropdown-item"><!----> <a href="/doc/d0009/" class="nav-link">通用大模型适配器</a></li><li class="dropdown-item"><!----> <a href="/doc/d0010/" class="nav-link">10分钟快速搭建个人博客</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/n0001/" aria-current="page" class="nav-link router-link-exact-active router-link-active">[学习笔记]Lua</a></li><li class="dropdown-item"><!----> <a href="/notes/n0002/" class="nav-link">[学习笔记]JVM</a></li><li class="dropdown-item"><!----> <a href="/notes/n0003/" class="nav-link">[学习笔记]设计模式</a></li><li class="dropdown-item"><!----> <a href="/notes/n0008/" class="nav-link">[学习笔记]Linux笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/n0004/" class="nav-link">[部署笔记]搭建Typecho博客</a></li><li class="dropdown-item"><!----> <a href="/notes/n0005/" class="nav-link">[部署笔记]部署Qsign签名机</a></li><li class="dropdown-item"><!----> <a href="/notes/n0006/" class="nav-link">[部署笔记]安装PVE系统</a></li><li class="dropdown-item"><!----> <a href="/notes/n0007/" class="nav-link">[部署笔记]部署KingBaseV9电科金仓</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><!----> <span class="title" style="display:;">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jx3/api/a0001/" class="nav-link">技艺成本</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="剑网三" class="dropdown-title"><!----> <span class="title" style="display:;">剑网三</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jx3/j0001/" class="nav-link">剑三网站合集</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0002/" class="nav-link">合并大区角色数据处理</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0003/" class="nav-link">25PT冷龙峰教学笔记</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0004/" class="nav-link">25PT太极宫教学笔记</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0005/" class="nav-link">25PT弓月城教学笔记</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/hidewnd/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章" class="dropdown-title"><!----> <span class="title" style="display:;">文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/doc/d0001/" class="nav-link">常用开发环境</a></li><li class="dropdown-item"><!----> <a href="/doc/d0002/" class="nav-link">常用提示词</a></li><li class="dropdown-item"><!----> <a href="/doc/d0003/" class="nav-link">常用Linux命令</a></li><li class="dropdown-item"><!----> <a href="/doc/d0004/" class="nav-link">Java开发聊天机器人</a></li><li class="dropdown-item"><!----> <a href="/doc/d0005/" class="nav-link">word模板生成实现方案</a></li><li class="dropdown-item"><!----> <a href="/doc/d0006/" class="nav-link">基于Go写一个极简的通讯demo</a></li><li class="dropdown-item"><!----> <a href="/doc/d0007/" class="nav-link">SpringBoot配置文件加密处理</a></li><li class="dropdown-item"><!----> <a href="/doc/d0008/" class="nav-link">SpringBoot优雅的抛出业务异常</a></li><li class="dropdown-item"><!----> <a href="/doc/d0009/" class="nav-link">通用大模型适配器</a></li><li class="dropdown-item"><!----> <a href="/doc/d0010/" class="nav-link">10分钟快速搭建个人博客</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记" class="dropdown-title"><!----> <span class="title" style="display:;">笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/n0001/" aria-current="page" class="nav-link router-link-exact-active router-link-active">[学习笔记]Lua</a></li><li class="dropdown-item"><!----> <a href="/notes/n0002/" class="nav-link">[学习笔记]JVM</a></li><li class="dropdown-item"><!----> <a href="/notes/n0003/" class="nav-link">[学习笔记]设计模式</a></li><li class="dropdown-item"><!----> <a href="/notes/n0008/" class="nav-link">[学习笔记]Linux笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/n0004/" class="nav-link">[部署笔记]搭建Typecho博客</a></li><li class="dropdown-item"><!----> <a href="/notes/n0005/" class="nav-link">[部署笔记]部署Qsign签名机</a></li><li class="dropdown-item"><!----> <a href="/notes/n0006/" class="nav-link">[部署笔记]安装PVE系统</a></li><li class="dropdown-item"><!----> <a href="/notes/n0007/" class="nav-link">[部署笔记]部署KingBaseV9电科金仓</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="API" class="dropdown-title"><!----> <span class="title" style="display:;">API</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jx3/api/a0001/" class="nav-link">技艺成本</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="剑网三" class="dropdown-title"><!----> <span class="title" style="display:;">剑网三</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jx3/j0001/" class="nav-link">剑三网站合集</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0002/" class="nav-link">合并大区角色数据处理</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0003/" class="nav-link">25PT冷龙峰教学笔记</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0004/" class="nav-link">25PT太极宫教学笔记</a></li><li class="dropdown-item"><!----> <a href="/jx3/j0005/" class="nav-link">25PT弓月城教学笔记</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/hidewnd/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/notes/n0001/" aria-current="page" class="active sidebar-link">Lua</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/notes/n0001/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header level2"><a href="/notes/n0001/#基础语法" class="sidebar-link">基础语法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/notes/n0001/#语法" class="sidebar-link">语法</a></li><li class="sidebar-sub-header level3"><a href="/notes/n0001/#基本变量" class="sidebar-link">基本变量</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#nil" class="sidebar-link">nil</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#number" class="sidebar-link">number</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#字符串" class="sidebar-link">字符串</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#table" class="sidebar-link">table</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#function" class="sidebar-link">function</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#thread" class="sidebar-link">thread</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#userdata" class="sidebar-link">userdata</a></li><li class="sidebar-sub-header level3"><a href="/notes/n0001/#循环" class="sidebar-link">循环</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#for" class="sidebar-link">for</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#while" class="sidebar-link">while</a></li><li class="sidebar-sub-header level4"><a href="/notes/n0001/#repeat-until" class="sidebar-link">repeat...until</a></li><li class="sidebar-sub-header level3"><a href="/notes/n0001/#if判断" class="sidebar-link">IF判断</a></li><li class="sidebar-sub-header level3"><a href="/notes/n0001/#运算符" class="sidebar-link">运算符</a></li><li class="sidebar-sub-header level3"><a href="/notes/n0001/#语法补充" class="sidebar-link">语法补充</a></li><li class="sidebar-sub-header level3"><a href="/notes/n0001/#协程" class="sidebar-link">协程</a></li></ul></li></ul></li><li><a href="/notes/n0002/" class="sidebar-link">JVM</a></li><li><a href="/notes/n0003/" class="sidebar-link">设计模式</a></li><li><a href="/notes/n0004/" class="sidebar-link">搭建Typecho博客</a></li><li><a href="/notes/n0005/" class="sidebar-link">Qsign 签名服务部署</a></li><li><a href="/notes/n0006/" class="sidebar-link">PVE部署笔记</a></li><li><a href="/notes/n0007/" class="sidebar-link">KingBaseV9部署笔记</a></li><li><a href="/notes/n0008/" class="sidebar-link">Linux笔记</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><span data-v-06225672>笔记</span></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/hidewnd" target="_blank" title="作者" class="beLink" data-v-06225672>hidewnd</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-03-24</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><!---->Lua<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="lua笔记"><a href="#lua笔记" class="header-anchor">#</a> Lua笔记</h1> <p>lua5.3参考手册： <a href="https://wiki.luatos.com/_static/lua53doc/contents.html#contents" target="_blank" rel="noopener noreferrer">luatos.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <blockquote><p>描述</p></blockquote> <p>Lua 是一种轻量小巧的脚本语言，用标准C语言编写并以源代码形式开放；
其设计目的是为了<strong>嵌入应用程序</strong>中，从而为应用程序提供灵活的扩展和定制功能。</p> <blockquote><p>特性</p></blockquote> <ul><li><strong>轻量级</strong></li> <li><strong>可扩展</strong></li> <li><strong>其它特性</strong>：支持面向过程、自动内存管理、语言内置模式匹配、支持面向对象</li></ul> <blockquote><p>应用场景</p></blockquote> <ul><li>游戏开发</li> <li>独立应用脚本</li> <li>Web 应用脚本</li> <li>扩展和数据库插件如：MySQL Proxy 和 MySQL WorkBench</li> <li>安全系统，如入侵检测系统</li></ul> <blockquote><p>Linux环境安装</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> <span class="token parameter variable">-R</span> <span class="token parameter variable">-O</span> http://www.lua.org/ftp/lua-5.3.0.tar.gz
<span class="token function">tar</span> zxf lua-5.3.0.tar.gz
<span class="token builtin class-name">cd</span> lua-5.3.0
<span class="token function">make</span> linux <span class="token builtin class-name">test</span>
<span class="token function">make</span> <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>MacOS环境安装</p></blockquote> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> <span class="token parameter variable">-R</span> <span class="token parameter variable">-O</span> http://www.lua.org/ftp/lua-5.3.0.tar.gz
<span class="token function">tar</span> zxf lua-5.3.0.tar.gz
<span class="token builtin class-name">cd</span> lua-5.3.0
<span class="token function">make</span> macosx <span class="token builtin class-name">test</span>
<span class="token function">make</span> <span class="token function">install</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>Window环境安装</p></blockquote> <ol><li>Github下载安装包
<ol><li>Github 下载地址 : <a href="https://github.com/rjpcomputing/luaforwindows/releases" target="_blank" rel="noopener noreferrer">https://github.com/rjpcomputing/luaforwindows/releases<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Google Code下载地址 : <a href="https://code.google.com/p/luaforwindows/downloads/list" target="_blank" rel="noopener noreferrer">https://code.google.com/p/luaforwindows/downloads/list<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></li> <li>双击安装后即可在该环境下编写 Lua 程序并运行</li></ol> <h2 id="基础语法"><a href="#基础语法" class="header-anchor">#</a> 基础语法</h2> <h3 id="语法"><a href="#语法" class="header-anchor">#</a> 语法</h3> <p>lua代码程序后缀 <code>.lua</code></p> <blockquote><p>打印</p></blockquote> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>注释</p></blockquote> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- 单行注释</span>

<span class="token comment">--[[
 多行注释
 多行注释
 --]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>变量命名</p></blockquote> <p>Lua 标示符用于定义一个变量，函数获取其他用户定义的项。
标示符以一个字母 A 到 Z 或 a 到 z 或下划线 _ 开头后加上 0 个或多个字母，下划线，数字（0 到 9）。
<strong>不要使用下划线加大写字母</strong>的标示符，因为Lua的保留字也是这样的。
<strong>Lua 不允许使用特殊字符如<code>@, $, 和 %</code> 来定义标示符。</strong>
 Lua 是一个<strong>区分大小写</strong>的编程语言。
 在默认情况下，<strong>变量总是认为是全局的</strong>。
PS：如果你想删除一个全局变量，只需要将变量赋值为nil。</p> <blockquote><p>关键词</p></blockquote> <p>一般约定，以下划线开头连接一串大写字母的名字（比如<code>_VERSION</code>）被保留用于 Lua 内部全局变量。</p> <table><thead><tr><th><strong>and</strong></th> <th><strong>break</strong></th> <th><strong>do</strong></th> <th><strong>else</strong></th></tr></thead> <tbody><tr><td><strong>elseif</strong></td> <td><strong>end</strong></td> <td><strong>false</strong></td> <td><strong>for</strong></td></tr> <tr><td><strong>function</strong></td> <td><strong>if</strong></td> <td><strong>in</strong></td> <td><strong>local</strong></td></tr> <tr><td><strong>nil</strong></td> <td><strong>not</strong></td> <td><strong>or</strong></td> <td><strong>repeat</strong></td></tr> <tr><td><strong>return</strong></td> <td><strong>then</strong></td> <td><strong>true</strong></td> <td><strong>until</strong></td></tr> <tr><td><strong>while</strong></td> <td><strong>goto</strong></td> <td></td> <td></td></tr></tbody></table> <blockquote><p>作用域</p></blockquote> <ol><li>全局变量
<ul><li>Lua 中的变量默认全局变量，无论语句块或是函数里</li> <li>变量默认值均为nil</li></ul></li> <li>局部变量
<ul><li><strong>用 local 显式声明为局部变量，局部变量只在被声明的那个代码块内有效</strong></li> <li>变量默认值均为nil</li> <li>代码块：指的是一个控制结构内，一个函数体，或者一个chunk（变量被声明的那个文件或者文本串）</li> <li>局部变量的作用域为<strong>从声明位置开始到所在语句块结束</strong></li></ul></li> <li>表中域</li></ol> <p>尽可能使用局部变量，有两个好处</p> <ul><li>避免命名冲突</li> <li>访问局部变量的速度比全局变量更快
<ul><li>原因是local变量是存放在lua的堆栈里面的是array操作，而全局变量是存放在_G中的table中，效率不及堆栈</li></ul></li></ul> <blockquote><p>数据类型</p></blockquote> <p>Lua 中有 8 个基本类型分别为：<code>nil、boolean、number、string、userdata、function、thread 和 table</code>。</p> <table><thead><tr><th>数据类型</th> <th>描述</th></tr></thead> <tbody><tr><td>nil</td> <td>只有值nil属于该类，表示一个无效值（在条件表达式中相当于false）。</td></tr> <tr><td>boolean</td> <td>包含两个值：false和true。</td></tr> <tr><td>number</td> <td>表示双精度类型的实浮点数</td></tr> <tr><td>string</td> <td>字符串由一对双引号或单引号来表示</td></tr> <tr><td>function</td> <td>由 C 或 Lua 编写的函数</td></tr> <tr><td>userdata</td> <td>表示任意存储在变量中的C数据结构</td></tr> <tr><td>thread</td> <td>表示执行的独立线路，用于执行协同程序</td></tr> <tr><td>table</td> <td>Lua 中的表（table）其实是一个&quot;关联数组&quot;（associative arrays），数组的索引可以是数字、字符串或表类型。在 Lua 里，table 的创建是通过&quot;构造表达式&quot;来完成，最简单构造表达式是{}，用来创建一个空表。</td></tr></tbody></table> <blockquote><p>实例</p></blockquote> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token comment">--&gt; string  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">10.4</span><span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>             <span class="token comment">--&gt; number  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>print<span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token comment">--&gt; function  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment">--&gt; function  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>               <span class="token comment">--&gt; boolean  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token keyword">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token comment">--&gt; nil  </span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment">--&gt; string</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="基本变量"><a href="#基本变量" class="header-anchor">#</a> 基本变量</h3> <h4 id="nil"><a href="#nil" class="header-anchor">#</a> nil</h4> <p><strong>nil 作比较时应该加上双引号 &quot;</strong>:  type(X) 实质是返回的 <strong>&quot;nil&quot;</strong> 字符串，是一个 string 类型</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token operator">&gt;</span> <span class="token function">type</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span>
<span class="token keyword">nil</span>
<span class="token operator">&gt;</span> <span class="token function">type</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">==</span><span class="token keyword">nil</span>
<span class="token keyword">false</span>
<span class="token operator">&gt;</span> <span class="token function">type</span><span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">&quot;nil&quot;</span>
<span class="token keyword">true</span>
<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>对于全局变量和 table，nil 还有一个&quot;删除&quot;作用，给全局变量或者 table 表里的变量赋一个 nil 值，等同于把它们删掉</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code>tab1 <span class="token operator">=</span> <span class="token punctuation">{</span> key1 <span class="token operator">=</span> <span class="token string">&quot;val1&quot;</span><span class="token punctuation">,</span> key2 <span class="token operator">=</span> <span class="token string">&quot;val2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;val3&quot;</span> <span class="token punctuation">}</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>tab1<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span>k <span class="token operator">..</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">..</span> v<span class="token punctuation">)</span>
<span class="token keyword">end</span>
 
tab1<span class="token punctuation">.</span>key1 <span class="token operator">=</span> <span class="token keyword">nil</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>tab1<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span>k <span class="token operator">..</span> <span class="token string">&quot; - &quot;</span> <span class="token operator">..</span> v<span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><hr> <h4 id="number"><a href="#number" class="header-anchor">#</a> number</h4> <p>Lua 把 false 和 nil 看作是 false，其他的都为 true，<strong>数字 0 也是 true</strong></p> <p>Lua <strong>默认只有一种 number 类型 -- double</strong>（双精度）类型（默认类型可以修改 luaconf.h 里的定义）</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">2.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">2e+1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">0.2e-1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">7.8263692594256e-06</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 字符串转number</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">tonumber</span><span class="token punctuation">(</span><span class="token string">&quot;3333&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 3333</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">tonumber</span><span class="token punctuation">(</span><span class="token string">&quot;aaa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- nil</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><blockquote><p>大小端</p></blockquote> <p>对于一个由2个字节组成的16位整数，在内存中存储这两个字节有两种方法：</p> <ul><li>小端(little-endian)字节序： 低序字节存储在起始地址</li> <li>大端(big-endian)字节序： 高序字节存储在起始地址。又称为网络序</li></ul> <div class="language-C line-numbers-mode"><pre class="language-c"><code><span class="token class-name">uint32_t</span> n <span class="token operator">=</span> <span class="token number">0x01020304</span>

# 大端顺序
<span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x04</span>
# 小端顺序
<span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x01</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>不同CPU型号大小端模式不同， 判断大小端方式</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
 
<span class="token comment">// 共用体中很重要的一点：a和b都是从u1的低地址开始存放的。</span>
<span class="token comment">// 假设u1所在的4字节地址分别是：0、1、2、3的话，那么a自然就是0、1、2、3；</span>
<span class="token comment">// b所在的地址是0而不是3.</span>
 
<span class="token keyword">union</span> myunion
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a<span class="token punctuation">;</span>
	<span class="token keyword">char</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
 
<span class="token comment">// 如果是小端模式则返回1，小端模式则返回0</span>
<span class="token keyword">int</span> <span class="token function">is_little_endian</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">union</span> myunion u1<span class="token punctuation">;</span>
	u1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">0x12345678</span><span class="token punctuation">;</span>				<span class="token comment">// 地址0的那个字节内是0x78（小端）或者0x12（大端）</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0x78</span> <span class="token operator">==</span> u1<span class="token punctuation">.</span>b<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0x12</span> <span class="token operator">==</span> u1<span class="token punctuation">.</span>b<span class="token punctuation">)</span>
	    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">int</span> <span class="token function">is_little_endian2</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0x12345678</span><span class="token punctuation">;</span>
	<span class="token keyword">char</span> b <span class="token operator">=</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 指针方式其实就是共用体的本质</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0x78</span> <span class="token operator">==</span> b<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0x12</span> <span class="token operator">==</span> b<span class="token punctuation">)</span>
	    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">is_little_endian2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//int i = is_little_endian();</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;小端模式\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;大端模式\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p>Lua中对二进制数据打包、解析</p> <div class="language-Lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">local</span> data <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">pack</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;L&quot;</span><span class="token punctuation">,</span> <span class="token number">0x01020304</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 4</span>
<span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 3</span>
<span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 2</span>
<span class="token function">print</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 1</span>
<span class="token keyword">local</span> str <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">unpack</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;L&quot;</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token comment">-- 16909060</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><hr> <h4 id="字符串"><a href="#字符串" class="header-anchor">#</a> 字符串</h4> <p>字符串由一对双引号或单引号来表示，也可以用 2 个方括号 &quot;[[]]&quot; 来表示&quot;一块&quot;字符串
lua中字符串可以存储任何Byte值
字符串下标从1开始，反序下标从-1开始</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code>string1 <span class="token operator">=</span> <span class="token string">&quot;this is string1&quot;</span>
string2 <span class="token operator">=</span> <span class="token string">'this is string2'</span>
html <span class="token operator">=</span> <span class="token string">[[
&lt;html&gt;
&lt;head&gt;&lt;/head&gt;
&lt;body&gt;
    &lt;a href=&quot;http://www.runoob.com/&quot;&gt;菜鸟教程&lt;/a&gt;
&lt;/body&gt;
&lt;/html&gt;
]]</span>
<span class="token function">print</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span>

<span class="token function">print</span><span class="token punctuation">(</span>str<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 49</span>
<span class="token function">print</span><span class="token punctuation">(</span>str<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- 49</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>在对一个数字字符串上进行算术操作时，Lua 会尝试将这个数字字符串转成一个数字</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span> <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token number">8.0</span>
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;6&quot;</span><span class="token punctuation">)</span>
<span class="token number">8.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>字符串连接使用 <code>..</code></p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span> <span class="token operator">..</span> <span class="token string">'b'</span><span class="token punctuation">)</span>
ab
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token number">157</span> <span class="token operator">..</span> <span class="token number">428</span><span class="token punctuation">)</span>
<span class="token number">157428</span>
<span class="token operator">&gt;</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>使用 # 来计算字符串的长度，放在字符串前面</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token operator">&gt;</span> len <span class="token operator">=</span> <span class="token string">&quot;www.runoob.com&quot;</span>
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token operator">#</span>len<span class="token punctuation">)</span>
<span class="token number">14</span>
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token operator">#</span><span class="token string">&quot;www.runoob.com&quot;</span><span class="token punctuation">)</span>
<span class="token number">14</span>
<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>语法糖</p> <div class="language-Lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">local</span> str <span class="token operator">=</span> <span class="token string">&quot;123&quot;</span>
<span class="token function">print</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">byte</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 49</span>
<span class="token function">print</span><span class="token punctuation">(</span>str<span class="token punctuation">:</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 49</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>内建函数</p></blockquote> <table><thead><tr><th style="text-align:left;">序号</th> <th style="text-align:left;">方法 &amp; 用途</th></tr></thead> <tbody><tr><td style="text-align:left;">string.upper</td> <td style="text-align:left;"><strong>string.upper(argument) :</strong> 字符串全部转为大写字母。</td></tr> <tr><td style="text-align:left;">string.lower</td> <td style="text-align:left;"><strong>string.lower(argument):</strong> 字符串全部转为小写字母。</td></tr> <tr><td style="text-align:left;">string.gsub</td> <td style="text-align:left;">**string.gsub(mainString,findString,replaceString,num)**在字符串中替换。mainString 为要操作的字符串， findString 为被替换的字符，replaceString 要替换的字符，num 替换次数（可以忽略，则全部替换），如：<code>&gt; string.gsub(&quot;aaaa&quot;,&quot;a&quot;,&quot;z&quot;,3); zzza 3</code></td></tr> <tr><td style="text-align:left;">string.find</td> <td style="text-align:left;"><strong>string.find (str, substr, [init, [plain]])</strong> 在一个指定的目标字符串 str 中搜索指定的内容 substr，如果找到了一个匹配的子串，就会返回这个子串的起始索引和结束索引，不存在则返回 nil。<strong>init</strong> 指定了搜索的起始位置，默认为 1，可以一个负数，表示从后往前数的字符个数。<strong>plain</strong> 表示是否使用简单模式，默认为 false，true 只做简单的查找子串的操作，false 表示使用使用正则模式匹配。以下实例查找字符串 &quot;Lua&quot; 的起始索引和结束索引位置：<code>&gt; string.find(&quot;Hello Lua user&quot;, &quot;Lua&quot;, 1) 7 9</code></td></tr> <tr><td style="text-align:left;">string.reverse</td> <td style="text-align:left;"><strong>string.reverse(arg)</strong> 字符串反转<code>&gt; string.reverse(&quot;Lua&quot;) auL</code></td></tr> <tr><td style="text-align:left;">string.forma</td> <td style="text-align:left;"><strong>string.format(...)</strong> 返回一个类似printf的格式化字符串<code>&gt; string.format(&quot;the value is:%d&quot;,4) the value is:4</code></td></tr> <tr><td style="text-align:left;">string.char/string.byte</td> <td style="text-align:left;"><strong>string.char(arg) 和 string.byte(arg[,int])</strong> char 将整型数字转成字符并连接， byte 转换字符为整数值(可以指定某个字符，默认第一个字符)。<code>&gt; string.char(97,98,99,100) abcd &gt; string.byte(&quot;ABCD&quot;,4) 68 &gt; string.byte(&quot;ABCD&quot;) 65 &gt;</code></td></tr> <tr><td style="text-align:left;">string.len</td> <td style="text-align:left;"><strong>string.len(arg)</strong> 计算字符串长度。<code>string.len(&quot;abc&quot;) 3</code></td></tr> <tr><td style="text-align:left;">string.rep</td> <td style="text-align:left;"><strong>string.rep(string, n)</strong> 返回字符串string的n个拷贝<code>&gt; string.rep(&quot;abcd&quot;,2) abcdabcd</code></td></tr> <tr><td style="text-align:left;">string.gmatch</td> <td style="text-align:left;"><strong>string.gmatch(str, pattern)</strong> 返回一个迭代器函数，每一次调用这个函数，返回一个在字符串 str 找到的下一个符合 pattern 描述的子串。如果参数 pattern 描述的字符串没有找到，迭代函数返回nil。<code>&gt; for word in string.gmatch(&quot;Hello Lua user&quot;, &quot;%a+&quot;) do print(word) end Hello Lua user</code></td></tr> <tr><td style="text-align:left;">string.match</td> <td style="text-align:left;"><strong>string.match(str, pattern, init)</strong> string.match()只寻找源字串str中的第一个配对. 参数init可选, 指定搜寻过程的起点, 默认为1。 在成功配对时, 函数将返回配对表达式中的所有捕获结果; 如果没有设置捕获标记, 则返回整个配对字符串. 当没有成功的配对时, 返回nil。<code>&gt; = string.match(&quot;I have 2 questions for you.&quot;, &quot;%d+ %a+&quot;) 2 questions &gt; = string.format(&quot;%d, %q&quot;, string.match(&quot;I have 2 questions for you.&quot;, &quot;(%d+) (%a+)&quot;)) 2, &quot;questions&quot;</code></td></tr> <tr><td style="text-align:left;">string.sub</td> <td style="text-align:left;"><strong>string.sub()：</strong> 用于截取字符串<code>string.sub(s, i [, j])</code>。s：要截取的字符串；i：截取开始位置；j：截取结束位置，默认为 -1，最后一个字符。</td></tr></tbody></table> <hr> <h4 id="table"><a href="#table" class="header-anchor">#</a> table</h4> <p>table 的创建是通过&quot;构造表达式&quot;来完成，最简单构造表达式是{}，用来创建一个空表；也可以在表里添加任意数据，直接初始化表</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- 创建一个空的 table</span>
<span class="token keyword">local</span> tbl1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
 
<span class="token comment">-- 直接初始表</span>
<span class="token keyword">local</span> tbl2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pear&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;orange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;grape&quot;</span><span class="token punctuation">}</span>

<span class="token comment">-- 构造键值对 </span>
<span class="token keyword">local</span> tbl3 <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">,</span> b<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span> <span class="token keyword">end</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&quot;,;&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">123</span> <span class="token punctuation">}</span>
<span class="token keyword">local</span> tbl4 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>对 table 的索引使用方括号 []。Lua 也提供了 . 操作。</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
t<span class="token punctuation">.</span>i                 <span class="token comment">-- 当索引为字符串类型时的一种简化写法</span>
<span class="token function">gettable_event</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>i<span class="token punctuation">)</span> <span class="token comment">-- 采用索引访问本质上是一个类似这样的函数调用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>table实质为&quot;关联数组&quot;（associative arrays），数组的索引可以是数字或者是字符串。</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code>a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  
a<span class="token punctuation">[</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;value&quot;</span>  
key <span class="token operator">=</span> <span class="token number">10</span>  
a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span>  
a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">11</span>  
<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">do</span>  
    <span class="token function">print</span><span class="token punctuation">(</span>k <span class="token operator">..</span> <span class="token string">&quot; : &quot;</span> <span class="token operator">..</span> v<span class="token punctuation">)</span>  
<span class="token keyword">end</span>

<span class="token comment">--[[
key : value
10 : 33
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>table默认初始索引一般以 1 开始，没有固定长度大小，随数据集新增而自动增长，未初始的数据返回nil
 ```lua
tb = {1,2,3,4}
print(tb[0]) -- nil
print(tb[1]) -- 1
tb[0] = &quot;11&quot;
print(tb[0]) -- 11
print(tb[4]) -- nil</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>全局变量统一存储在全局表（`_G`）中
```Lua
tb = {1,2,3,4}
print(_G) -- table: 0x24ffb80
print(_G.tb[1]) -- 1
print(_G.table.insert) -- function: 0x41d420

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>迭代器：pairs/ipairs</p> <ul><li>pairs： 用于迭代table所有数据 返回下标以及值</li> <li>ipairs：用于返回int类型下标的数据，遇到不连续的下标时终止循环</li> <li>内部同步next(table，index)函数实现</li></ul> <div class="language-Lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> index<span class="token punctuation">,</span>value <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">do</span>
	<span class="token function">print</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token comment">--[[
1	5  
0	a  
6	b  
4	4
]]</span>


<span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;e&quot;</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token keyword">do</span>
	<span class="token function">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
	<span class="token keyword">end</span>
<span class="token comment">--[[
1	a  
2	b  
3	c  
4	d
]]</span>

<span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">&quot;e&quot;</span><span class="token punctuation">}</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">-- 1   a</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 6	e</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- nil</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- nil</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><hr> <h4 id="function"><a href="#function" class="header-anchor">#</a> function</h4> <blockquote><p>Lua 编程语言函数定义格式如下：</p></blockquote> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code>optional_function_scope <span class="token keyword">function</span> <span class="token function">function_name</span><span class="token punctuation">(</span> argument1<span class="token punctuation">,</span> argument2<span class="token punctuation">,</span> argument3<span class="token punctuation">...</span><span class="token punctuation">,</span> argumentn<span class="token punctuation">)</span>
    function_body
    <span class="token keyword">return</span> result_params_comma_separated
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>optional_function_scope:</strong> 该参数是可选的指定函数是全局函数还是局部函数，未设置该参数默认为全局函数，如果你需要设置函数为局部函数需要使用关键字 <strong>local</strong>。</li> <li><strong>function_name:</strong> 指定函数名称。</li> <li><strong>argument1, argument2, argument3..., argumentn:</strong> 函数参数，多个参数以逗号隔开，函数也可以不带参数。</li> <li><strong>function_body:</strong> 函数体，函数中需要执行的代码语句块。</li> <li><strong>result_params_comma_separated:</strong> 函数返回值，Lua语言函数可以返回多个值，每个值以逗号隔开。</li></ul> <p>在 Lua 中，函数是被看作是&quot;第一类值（First-Class Value）&quot;，函数可以存在变量里</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">factorial1</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>  
    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">then</span>  
        <span class="token keyword">return</span> <span class="token number">1</span>  
    <span class="token keyword">else</span>  
        <span class="token keyword">return</span> n <span class="token operator">*</span> <span class="token function">factorial1</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>  
    <span class="token keyword">end</span>  
<span class="token keyword">end</span>  
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">factorial1</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
factorial2 <span class="token operator">=</span> factorial1  
<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">factorial2</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">--[[
120
120
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>function 可以以匿名函数（anonymous function）的方式通过参数传递</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">testFun</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span>fun<span class="token punctuation">)</span>  
        <span class="token keyword">for</span> k <span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">pairs</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span> <span class="token keyword">do</span>  
                <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">fun</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        <span class="token keyword">end</span>  
<span class="token keyword">end</span>  
  
  
tab<span class="token operator">=</span><span class="token punctuation">{</span>key1<span class="token operator">=</span><span class="token string">&quot;val1&quot;</span><span class="token punctuation">,</span>key2<span class="token operator">=</span><span class="token string">&quot;val2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  
<span class="token function">testFun</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span>  
<span class="token keyword">function</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token comment">--匿名函数  </span>
        <span class="token keyword">return</span> key<span class="token operator">..</span><span class="token string">&quot;=&quot;</span><span class="token operator">..</span>val<span class="token punctuation">;</span>  
<span class="token keyword">end</span>

<span class="token comment">--[[
key1=val1
key2=val2
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>Lua函数可以返回多个结果值，比如string.find，其返回匹配串&quot;开始和结束的下标&quot;（如果不存在匹配串返回nil）。在return后列出要返回的值的列表即可返回多值</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token operator">&gt;</span> s<span class="token punctuation">,</span> e <span class="token operator">=</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">&quot;www.runoob.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;runoob&quot;</span><span class="token punctuation">)</span> 
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token comment">-- 5    10</span>

<span class="token keyword">function</span> <span class="token function">maximum</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">local</span> mi <span class="token operator">=</span> <span class="token number">1</span>             <span class="token comment">-- 最大值索引</span>
    <span class="token keyword">local</span> m <span class="token operator">=</span> a<span class="token punctuation">[</span>mi<span class="token punctuation">]</span>          <span class="token comment">-- 最大值</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span>val <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">do</span>
       <span class="token keyword">if</span> val <span class="token operator">&gt;</span> m <span class="token keyword">then</span>
           mi <span class="token operator">=</span> i
           m <span class="token operator">=</span> val
       <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    <span class="token keyword">return</span> m<span class="token punctuation">,</span> mi
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token function">maximum</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 23    3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Lua 函数可以接受可变数目的参数，和 C 语言类似，在函数参数列表中使用三点 <code>...</code>表示函数有可变的参数。</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>
   result <span class="token operator">=</span> <span class="token number">0</span>
   <span class="token keyword">local</span> arg<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span>    <span class="token comment">--&gt; arg 为一个表，局部变量</span>
   <span class="token keyword">for</span> i<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token keyword">do</span>
      result <span class="token operator">=</span> result <span class="token operator">+</span> v
   <span class="token keyword">end</span>
   <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;总共传入 &quot;</span> <span class="token operator">..</span> <span class="token operator">#</span>arg <span class="token operator">..</span> <span class="token string">&quot; 个数&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> result<span class="token operator">/</span><span class="token operator">#</span>arg
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;平均值为&quot;</span><span class="token punctuation">,</span><span class="token function">average</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[
总共传入 6 个数
平均值为    5.5
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>我们也可以通过<code>select(&quot;#&quot;,...)</code>来获取可变参数的数量:</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">average</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>
   result <span class="token operator">=</span> <span class="token number">0</span>
   <span class="token keyword">local</span> arg<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token punctuation">}</span>
   <span class="token keyword">for</span> i<span class="token punctuation">,</span>v <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token keyword">do</span>
      result <span class="token operator">=</span> result <span class="token operator">+</span> v
   <span class="token keyword">end</span>
   <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;总共传入 &quot;</span> <span class="token operator">..</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">&quot; 个数&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">return</span> result<span class="token operator">/</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;#&quot;</span><span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;平均值为&quot;</span><span class="token punctuation">,</span><span class="token function">average</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">--[[
总共传入 6 个数
平均值为    5.5
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>固定参数必须放在变长参数之前</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">fwrite</span><span class="token punctuation">(</span>fmt<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span>  <span class="token comment">---&gt; 固定的参数fmt</span>
    <span class="token keyword">return</span> io<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>fmt<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    
<span class="token keyword">end</span>

<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token string">&quot;runoob\n&quot;</span><span class="token punctuation">)</span>       <span class="token comment">---&gt;fmt = &quot;runoob&quot;, 没有变长参数。  </span>
<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token string">&quot;%d%d\n&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">---&gt;fmt = &quot;%d%d&quot;, 变长参数为 1 和 2</span>

<span class="token comment">--[[
runoob
12
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>通常在遍历变长参数的时候只需要使用 <strong>{…}</strong>，然而变长参数可能会包含一些 <strong>nil</strong>，那么就可以用 <strong>select</strong> 函数来访问变长参数了：<strong>select('#', …)</strong> 或者 <strong>select(n, …)</strong></p> <ul><li><strong>select('#', …)</strong> 返回可变参数的长度。</li> <li><strong>select(n, …)</strong> 用于返回从起点 <strong>n</strong> 开始到结束位置的所有参数列表。</li> <li>调用 select 时，必须传入一个固定实参 selector(选择开关) 和一系列变长参数。如果 selector 为数字 n，那么 select 返回参数列表中从索引 <strong>n</strong> 开始到结束位置的所有参数列表，否则只能为字符串 <strong>#</strong>，这样 select 返回变长参数的总数。</li></ul> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">...</span><span class="token punctuation">)</span>
    a <span class="token operator">=</span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token punctuation">)</span>  <span class="token comment">--&gt;从第三个位置开始，变量 a 对应右边变量列表的第一个参数</span>
    <span class="token function">print</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token function">print</span> <span class="token punctuation">(</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">...</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">--&gt;打印所有列表参数</span>
<span class="token keyword">end</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment">--[[
2
2       3       4       5
]]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><hr> <h4 id="thread"><a href="#thread" class="header-anchor">#</a> thread</h4> <p>在 Lua 里，最主要的线程是协同程序（coroutine）。它跟线程（thread）差不多，拥有自己独立的栈、局部变量和指令指针，可以跟其他协同程序共享全局变量和其他大部分东西。</p> <p>线程跟协程的区别：线程可以同时多个运行，而协程任意时刻只能运行一个，并且处于运行状态的协程只有被挂起（suspend）时才会暂停。</p> <h4 id="userdata"><a href="#userdata" class="header-anchor">#</a> userdata</h4> <p>userdata 是一种用户自定义数据，用于表示一种由应用程序或 C/C++ 语言库所创建的类型，可以将任意 C/C++ 的任意数据类型的数据（通常是 struct 和 指针）存储到 Lua 变量中调用。</p> <h3 id="循环"><a href="#循环" class="header-anchor">#</a> 循环</h3> <h4 id="for"><a href="#for" class="header-anchor">#</a> for</h4> <p>重复执行指定语句，重复次数可在 for 语句中控制。</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- 数值for循环</span>
<span class="token comment">-- for的三个表达式在循环开始前一次性求值，以后不再进行求值。</span>
<span class="token comment">-- var 从 exp1 变化到 exp2，每次变化以 exp3 为步长递增 var，并执行一次 **&quot;执行体&quot;**。</span>
<span class="token comment">-- exp3 是可选的，如果不指定，默认为1。</span>
<span class="token keyword">for</span> var<span class="token operator">=</span>exp1<span class="token punctuation">,</span>exp2<span class="token punctuation">,</span>exp3 <span class="token keyword">do</span>  
<span class="token comment">-- &lt;执行体&gt;  </span>
<span class="token keyword">end</span>

<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>    
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span>    
    <span class="token keyword">return</span> x<span class="token operator">*</span><span class="token number">2</span>    
<span class="token keyword">end</span>    
<span class="token keyword">for</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">do</span> 
	<span class="token function">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>    
<span class="token keyword">end</span>


<span class="token comment">-- 泛型for循环</span>
<span class="token comment">-- i是数组索引值，v是对应索引的数组元素值。</span>
<span class="token comment">-- ipairs是Lua提供的一个迭代器函数，用来迭代数组。</span>
a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;three&quot;</span><span class="token punctuation">}</span>
<span class="token keyword">for</span> i<span class="token punctuation">,</span> v <span class="token keyword">in</span> <span class="token function">ipairs</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="while"><a href="#while" class="header-anchor">#</a> while</h4> <p>在条件为 true 时，让程序重复地执行某些语句。执行语句前会先检查条件是否为 true。</p> <h4 id="repeat-until"><a href="#repeat-until" class="header-anchor">#</a> repeat...until</h4> <p>重复执行循环，直到 指定的条件为真时为止</p> <hr> <h3 id="if判断"><a href="#if判断" class="header-anchor">#</a> IF判断</h3> <p>Lua 编程语言流程控制语句通过程序设定一个或多个条件语句来设定。在条件为 true 时执行指定程序代码，在条件为 false 时执行其他指定代码。</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- 示例1[ 0 为 true ]</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">then</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;0 为 true&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- 示例2 [ 定义变量 --]</span>
a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">--[ 检查条件 --]</span>
<span class="token keyword">if</span><span class="token punctuation">(</span> a <span class="token operator">&lt;</span> <span class="token number">20</span> <span class="token punctuation">)</span>
<span class="token keyword">then</span>
   <span class="token comment">--[ if 条件为 true 时执行该语句块 --]</span>
   <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;a 小于 20&quot;</span> <span class="token punctuation">)</span>
<span class="token keyword">else</span>
   <span class="token comment">--[ if 条件为 false 时执行该语句块 --]</span>
   <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;a 大于 20&quot;</span> <span class="token punctuation">)</span>
<span class="token keyword">end</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;a 的值为 :&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>

<span class="token keyword">local</span> a <span class="token operator">=</span> <span class="token keyword">nil</span>
<span class="token keyword">local</span> b <span class="token operator">=</span> <span class="token number">0</span>
<span class="token function">print</span><span class="token punctuation">(</span>a <span class="token keyword">or</span> b<span class="token punctuation">)</span> <span class="token comment">-- 0</span>
<span class="token function">print</span><span class="token punctuation">(</span>a <span class="token keyword">and</span> b<span class="token punctuation">)</span> <span class="token comment">-- nil</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">not</span> a<span class="token punctuation">)</span> <span class="token comment">-- true</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token keyword">not</span> b<span class="token punctuation">)</span> <span class="token comment">-- false</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h3 id="运算符"><a href="#运算符" class="header-anchor">#</a> 运算符</h3> <blockquote><p>算数运算符</p></blockquote> <table><thead><tr><th>+</th> <th>加法</th> <th>A + B 输出结果 30</th></tr></thead> <tbody><tr><td>-</td> <td>减法</td> <td>A - B 输出结果 -10</td></tr> <tr><td>*</td> <td>乘法</td> <td>A * B 输出结果 200</td></tr> <tr><td>/</td> <td>除法</td> <td>B / A 输出结果 2</td></tr> <tr><td>%</td> <td>取余</td> <td>B % A 输出结果 0</td></tr> <tr><td>^</td> <td>乘幂</td> <td>A^2 输出结果 100</td></tr> <tr><td>-</td> <td>负号</td> <td>-A 输出结果 -10</td></tr> <tr><td>//</td> <td>整除运算符(&gt;=lua5.3)</td> <td><strong>5//2</strong> 输出结果 2</td></tr></tbody></table> <blockquote><p>关系运算符</p></blockquote> <table><thead><tr><th>==</th> <th>等于，检测两个值是否相等，相等返回 true，否则返回 false</th> <th>(A == B) 为 false。</th></tr></thead> <tbody><tr><td>~=</td> <td>不等于，检测两个值是否相等，不相等返回 true，否则返回 false</td> <td>(A ~= B) 为 true。</td></tr> <tr><td>&gt;</td> <td>大于，如果左边的值大于右边的值，返回 true，否则返回 false</td> <td>(A &gt; B) 为 false。</td></tr> <tr><td>&lt;</td> <td>小于，如果左边的值大于右边的值，返回 false，否则返回 true</td> <td>(A &lt; B) 为 true。</td></tr> <tr><td>&gt;=</td> <td>大于等于，如果左边的值大于等于右边的值，返回 true，否则返回 false</td> <td>(A &gt;= B) 返回 false。</td></tr> <tr><td>&lt;=</td> <td>小于等于， 如果左边的值小于等于右边的值，返回 true，否则返回 false</td> <td>(A &lt;= B) 返回 true。</td></tr></tbody></table> <blockquote><p>逻辑运算符</p></blockquote> <table><thead><tr><th>and</th> <th>逻辑与操作符。 若 A 为 false，则返回 A，否则返回 B。</th> <th>(A and B) 为 false。</th></tr></thead> <tbody><tr><td>or</td> <td>逻辑或操作符。 若 A 为 true，则返回 A，否则返回 B。</td> <td>(A or B) 为 true。</td></tr> <tr><td>not</td> <td>逻辑非操作符。与逻辑运算结果相反，如果条件为 true，逻辑非为 false。</td> <td>not(A and B) 为 true。</td></tr></tbody></table> <blockquote><p>others</p></blockquote> <table><thead><tr><th>..</th> <th>连接两个字符串</th> <th>a..b ，其中 a 为 &quot;Hello &quot; ， b 为 &quot;World&quot;, 输出结果为 &quot;Hello World&quot;。</th></tr></thead> <tbody><tr><td>#</td> <td>一元运算符，返回字符串或表的长度。</td> <td>#&quot;Hello&quot; 返回 5</td></tr></tbody></table> <blockquote><p>优先级</p></blockquote> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- 从高到低</span>
<span class="token operator">^</span>
<span class="token keyword">not</span>    <span class="token operator">-</span> <span class="token punctuation">(</span>unary<span class="token punctuation">)</span>
<span class="token operator">*</span>      <span class="token operator">/</span>       <span class="token operator">%</span>
<span class="token operator">+</span>      <span class="token operator">-</span>
<span class="token operator">..</span>
<span class="token operator">&lt;</span>      <span class="token operator">&gt;</span>      <span class="token operator">&lt;=</span>     <span class="token operator">&gt;=</span>     <span class="token operator">~=</span>     <span class="token operator">==</span>
<span class="token keyword">and</span>
<span class="token keyword">or</span>
<span class="token comment">-- 除了 ^ 和 .. 外所有的二元运算符都是左连接的。</span>
a<span class="token operator">+</span>i <span class="token operator">&lt;</span> b<span class="token operator">/</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span>          <span class="token comment">--       (a+i) &lt; ((b/2)+1)</span>
<span class="token number">5</span><span class="token operator">+</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">8</span>              <span class="token comment">--       5+((x^2)*8)</span>
a <span class="token operator">&lt;</span> y <span class="token keyword">and</span> y <span class="token operator">&lt;=</span> z     <span class="token comment">--       (a &lt; y) and (y &lt;= z)</span>
<span class="token operator">-</span>x<span class="token operator">^</span><span class="token number">2</span>                 <span class="token comment">--       -(x^2)</span>
x<span class="token operator">^</span>y<span class="token operator">^</span>z                <span class="token comment">--       x^(y^z)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="语法补充"><a href="#语法补充" class="header-anchor">#</a> 语法补充</h3> <blockquote><p>多文件调用</p></blockquote> <p>关键字：<code>require</code></p> <ul><li>运行指定文件，且被调用文件指挥运行一次</li> <li>末尾不带lua，自动匹配lua文件</li> <li>目录层级使用”.“分隔</li> <li>基本路径： <code>package.path</code>
示例：</li></ul> <div class="language-Lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- \path\txt_1.lua</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;txt_1 runtime!&quot;</span><span class="token punctuation">)</span>

<span class="token comment">-- txt_2.lua</span>
<span class="token function">require</span><span class="token punctuation">(</span>&quot;path<span class="token punctuation">.</span>txt_1<span class="token punctuation">)</span>


<span class="token comment">-- 设置默认引入包路径</span>
package<span class="token punctuation">.</span>path <span class="token operator">=</span> package<span class="token punctuation">.</span>path<span class="token operator">..</span><span class="token string">&quot;;./lua/?.lua&quot;</span>

<span class="token comment">-- 封装包</span>

<span class="token comment">-- Person.lua</span>
<span class="token keyword">local</span> person <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> person<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;run!&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">end</span>

<span class="token comment">-- app.lua</span>
<span class="token keyword">local</span> person <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;Person&quot;</span><span class="token punctuation">)</span>
person<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><blockquote><p>元表</p></blockquote> <p>Lua 中的每个值都可以有一个 <em>元表</em>。 这个 <em>元表</em> 就是一个普通的 Lua 表， 它用于定义原始值在特定操作下的行为。 如果你想改变一个值在特定操作下的行为，你可以在它的元表中设置对应域。 例如，当你对非数字值做加操作时， Lua 会检查该值的元表中的 &quot;<code>__add</code>&quot; 域下的函数。 如果能找到，Lua 则调用这个函数来完成加这个操作。</p> <ul><li>在元表中事件的键值是一个双下划线（<code>__</code>）加事件名的字符串； 键关联的那些值被称为 <em>元方法</em>。</li> <li>使用 <code>setmetatable</code> 来替换一张表的元表。</li> <li>元表决定了一个对象在数学运算、位运算、比较、连接、 取长度、调用、索引时的行为。</li> <li>元表还可以定义一个函数，当表对象或用户数据对象在垃圾回收时调用它。</li> <li>对于一元操作符（取负、求长度、位反）， 元方法调用的时候，第二个参数是个哑元，其值等于第一个参数。 这样处理仅仅是为了简化 Lua 的内部实现 （这样处理可以让所有的操作都和二元操作一致）， 这个行为有可能在将来的版本中移除。 （使用这个额外参数的行为都是不确定的。）</li></ul> <div class="language-Lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span>v<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> t2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span>
<span class="token keyword">local</span> addT <span class="token operator">=</span> <span class="token punctuation">{</span>
	__add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>
		<span class="token keyword">return</span> i<span class="token punctuation">.</span>v<span class="token operator">+</span><span class="token number">1</span>
		<span class="token keyword">end</span><span class="token punctuation">,</span>
	__index <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> index<span class="token punctuation">)</span> 
		<span class="token keyword">return</span> <span class="token string">&quot;null&quot;</span>
		<span class="token keyword">end</span>
	<span class="token comment">-- 类似构造函数</span>
	__newindex <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
		<span class="token comment">-- 类似super</span>
		<span class="token function">rawset</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> key<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
		<span class="token keyword">end</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
<span class="token keyword">local</span> addT2 <span class="token operator">=</span> <span class="token punctuation">{</span>
	__add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>j<span class="token punctuation">)</span>
		<span class="token keyword">return</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span>
		<span class="token keyword">end</span><span class="token punctuation">,</span>
	__index <span class="token operator">=</span> <span class="token punctuation">{</span>
		a <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span>
		b <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">setmetatable</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>addT<span class="token punctuation">)</span>
<span class="token function">setmetatable</span><span class="token punctuation">(</span>t2<span class="token punctuation">,</span>addT2<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>t<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>      <span class="token comment">--15</span>
<span class="token function">print</span><span class="token punctuation">(</span>t2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment">-- 11</span>
<span class="token function">print</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment">-- null</span>
<span class="token function">print</span><span class="token punctuation">(</span>t2<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">-- a</span>
<span class="token function">print</span><span class="token punctuation">(</span>t2<span class="token punctuation">[</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment">--nil</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><blockquote><p>面向对象</p></blockquote> <p>语法糖使用</p> <div class="language-lua line-numbers-mode"><pre class="language-lua"><code><span class="token keyword">local</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
	value <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
	add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> sum<span class="token punctuation">)</span>
		tab<span class="token punctuation">.</span>value <span class="token operator">=</span> tab<span class="token punctuation">.</span>value <span class="token operator">+</span> sum
		<span class="token keyword">end</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
object<span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token comment">-- 7</span>

<span class="token comment">-- 实现一个list</span>
list <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">-- 定义提供的调用接口</span>
listmt <span class="token operator">=</span> <span class="token punctuation">{</span>
	add <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> value<span class="token punctuation">)</span>
		table<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>items<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
	<span class="token keyword">end</span><span class="token punctuation">,</span>
	get <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
		<span class="token keyword">return</span> t<span class="token punctuation">.</span>items<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
	<span class="token keyword">end</span><span class="token punctuation">,</span>
	remove <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> index<span class="token punctuation">)</span>
		<span class="token keyword">if</span> <span class="token keyword">not</span> index <span class="token keyword">then</span>
			index <span class="token operator">=</span> <span class="token operator">#</span>t<span class="token punctuation">.</span>items
		<span class="token keyword">end</span>
		table<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>items<span class="token punctuation">,</span>index<span class="token punctuation">)</span>	
	<span class="token keyword">end</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
listmt<span class="token punctuation">[</span><span class="token string">&quot;__index&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> listmt
<span class="token comment">-- 定义构造函数</span>
<span class="token keyword">function</span> list<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
	<span class="token keyword">local</span> t <span class="token operator">=</span> <span class="token punctuation">{</span>
		items<span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token function">setmetatable</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> listmt<span class="token punctuation">)</span>
	<span class="token keyword">return</span> t
<span class="token keyword">end</span>
<span class="token comment">-- 对象创建及调用</span>
<span class="token keyword">local</span> obj <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
obj<span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span>
obj<span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">)</span>
obj<span class="token punctuation">:</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- b</span>

obj<span class="token punctuation">:</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>obj<span class="token punctuation">:</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- b</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h3 id="协程"><a href="#协程" class="header-anchor">#</a> 协程</h3> <blockquote><p>描述</p></blockquote> <p>Lua 支持协程，也叫 <em>协同式多线程</em>。 一个协程在 Lua 中代表了一段独立的执行线程。 然而，与多线程系统中的线程的区别在于， 协程仅在显式调用一个让出（yield）函数时才挂起当前的执行</p> <p>调用函数<code>coroutine.create</code> 可创建一个协程。 其唯一的参数是该协程的主函数。 create 函数只负责新建一个协程并返回其句柄 （一个 thread 类型的对象）； 而不会启动该协程。</p> <p>调用 <code>coroutine.resume</code> 函数执行一个协程。
第一次调用 <code>coroutine.resume</code> 时，第一个参数应传入 <code>coroutine.create</code>返回的线程对象，然后协程从其主函数的第一行开始执行。
传递给<code>coroutine.resume</code> 的其他参数将作为协程主函数的参数传入。
协程启动之后，将一直运行到它终止或 让出。</p> <p><strong>协程的运行可能被两种方式终止：</strong></p> <ul><li>正常途径是主函数返回 （显式返回或运行完最后一条指令），<code>coroutine.resume</code> 将返回 true， 并接上协程主函数的返回值。</li> <li>非正常途径是发生了一个未被捕获的错误， 当错误发生时， <code>coroutine.resume</code>将返回 false 与错误消息。</li></ul> <p>通过调用<code>coroutine.yield</code>使协程暂停执行，让出执行权。 协程让出时，对应的最近 <code>coroutine.resume</code>函数会立刻返回，即使该让出操作发生在内嵌函数调用中 （即不在主函数，但在主函数直接或间接调用的函数内部）。
在协程让出的情况下，<code>coroutine.resume</code> 也会返回 true， 并加上传给 <code>coroutine.yield</code> 的参数。 当下次重启同一个协程时， 协程会接着从让出点继续执行。 此时，此前让出点处对 <code>coroutine.yield</code> 的调用 会返回，返回值为传给 <code>coroutine.resume</code>的第一个参数之外的其他参数。</p> <blockquote><p>示例</p></blockquote> <div class="language-Lua line-numbers-mode"><pre class="language-lua"><code><span class="token comment">-- 创建一个协程</span>
co <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span> 
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'create'</span><span class="token punctuation">,</span> arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">)</span>
    <span class="token comment">-- 暂停协程</span>
    <span class="token keyword">local</span> v1<span class="token punctuation">,</span> v2 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span>co<span class="token punctuation">,</span> <span class="token string">'yield 111'</span><span class="token punctuation">,</span> <span class="token string">'yield 222'</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'yield'</span><span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'create'</span><span class="token operator">..</span>arg1<span class="token punctuation">,</span> <span class="token string">'create'</span><span class="token operator">..</span>arg2
    <span class="token keyword">end</span>

<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 执行协程 直至结束或暂停</span>
val1<span class="token punctuation">,</span> val2 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">,</span> <span class="token string">'111'</span><span class="token punctuation">,</span> <span class="token string">'222'</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'resume1'</span><span class="token punctuation">,</span> val1<span class="token punctuation">,</span> val2<span class="token punctuation">)</span>
<span class="token comment">-- 再次执行、或从暂停处继续执行</span>
val1<span class="token punctuation">,</span> val2 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>co<span class="token punctuation">,</span> <span class="token string">'333'</span><span class="token punctuation">,</span> <span class="token string">'444'</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'resume2'</span><span class="token punctuation">,</span> val1<span class="token punctuation">,</span> val2<span class="token punctuation">)</span>

<span class="token comment">-- 使用 ccoroutine.wrap封装 </span>
co <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">wrap</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>arg1<span class="token punctuation">,</span> arg2<span class="token punctuation">)</span> 
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'create'</span><span class="token punctuation">,</span> arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">)</span>
    <span class="token keyword">local</span> v1<span class="token punctuation">,</span> v2 <span class="token operator">=</span> coroutine<span class="token punctuation">.</span><span class="token function">yield</span><span class="token punctuation">(</span>co<span class="token punctuation">,</span> <span class="token string">'yield 111'</span><span class="token punctuation">,</span> <span class="token string">'yield 222'</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'yield'</span><span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'create'</span><span class="token operator">..</span>arg1<span class="token punctuation">,</span> <span class="token string">'create'</span><span class="token operator">..</span>arg2
    <span class="token keyword">end</span>

<span class="token punctuation">)</span><span class="token punctuation">;</span>
val1<span class="token punctuation">,</span> val2 <span class="token operator">=</span> <span class="token function">co</span><span class="token punctuation">(</span><span class="token string">'111'</span><span class="token punctuation">,</span> <span class="token string">'222'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/hidewnd/documents/edit/main/docs/02.笔记/01.[学习笔记]Lua.md" target="_blank" rel="noopener noreferrer">帮助我改善此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/08/01, 00:28:53</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/notes/n0002/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">JVM</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/notes/n0002/">JVM</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://github.com/hidewnd" title="Github" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/hidewnd" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://www.bilibili.com/" title="Bilibili" target="_blank" class="iconfont icon-bilibili"></a><a href="https://www.sunofbeach.net/" title="阳光沙滩" target="_blank" class="iconfont icon-shuben"></a><a href="https://www.ermao.net/" title="二猫子博客" target="_blank" class="iconfont icon-maomao"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2026
    <span>Hidewnd</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5a211078.js" defer></script><script src="/assets/js/2.246ca7c3.js" defer></script><script src="/assets/js/16.13dc6cfd.js" defer></script>
  </body>
</html>
